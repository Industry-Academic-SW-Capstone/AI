import pandas as pd

# --- 1. 그룹 번호(숫자)와 스타일 태그 매핑 정의 ---

# 1-1. 짧은 태그 이름 정의 (final_style_tag 컬럼에 사용)
tag_mapping = {
    0: '[안정형 일반주]',
    1: '[고효율 우량주]',
    2: '[초고배당 가치주]',
    3: '[고위험 저평가주]',
    4: '[고성장 기대주]',
    5: '[초대형 우량주]',
    6: '[초저평가 가치주]',
    7: '[고가치 성장주]'
}

# 1-2. 상세 설명 정의 (style_description 컬럼에 사용)
# 주린이 관점 해석까지 포함한 긴 텍스트를 담습니다.
description_mapping = {
    0: """안정적인 보통 주식: 회사가 빚(부채)이 적어서 일단 망할 위험이 낮아요. 하지만 돈을 벌어들이는 효율(ROE)이 평범해서, 주가가 폭발적으로 오르지도 않을 거예요.""",
    1: """숨겨진 보물 우량주: PER이 낮아서 (버는 돈 대비 주가가 저렴해서) 저평가되어 있어요. 게다가 ROE가 높아서 (자기 돈으로 장사를 매우 잘해서) 효율성이 뛰어난 믿음직한 기업이에요.""",
    2: """초고배당 가치주: 다른 주식들보다 배당수익률이 압도적으로 높아요. (주식을 은행 이자처럼 사는 개념) PER이 낮아 (저렴해서) 현재의 가치도 괜찮은 그룹이에요.""",
    3: """고위험 저평가주: PBR이 매우 낮아 (회사가 가진 재산보다 주가가 훨씬 싸요). But! 부채비율이 너무 높아 (빚이 많아) 잘못되면 크게 위험해질 수 있어요.""",
    4: """고성장 기대주: PER이 엄청나게 높아요. (회사가 버는 돈에 비해 주가가 매우 비싸요). 이는 사람들이 이 회사가 '앞으로 엄청난 대박을 칠 것'이라고 기대하기 때문이에요.""",
    5: """초대형 우량주: 시가총액이 가장 커요. (회사의 덩치가 가장 커요). 워낙 크기 때문에 크게 오르기는 어렵지만, 시장을 대표하는 안정적인 그룹이에요.""",
    6: """초저평가 가치주: PER과 PBR이 가장 낮고 (가장 저렴함) 부채비율도 가장 낮아 (가장 안전함) '싸고 안전한 종목'을 찾는 정석적인 가치투자자들이 선호하는 그룹이에요.""",
    7: """고가치 성장주: PBR이 높아 (이미 비싸지만) ROE도 높아 (실제로 돈도 잘 벌고 효율도 좋음). 시장에서 '비싼 값을 지불할 가치'가 있다고 인정받는 성장 기업 그룹이에요."""
}


# --- 2. 최종 태그 결과 파일 로드 ---
input_file = 'app/data/stockit_ai_tags_final_v1.csv'
try:
    df = pd.read_csv(input_file, encoding='utf-8')
    print(f"로드 성공: {input_file}")
except Exception as e:
    print(f"파일 로드 실패: {e}")
    exit()

# --- 3. 태그 및 설명 매핑 적용 (핵심 로직) ---
# 1. 짧은 태그 이름 적용
df['final_style_tag'] = df['group_tag'].map(tag_mapping)

# 2. 상세 설명 적용 (추가된 부분)
df['style_description'] = df['group_tag'].map(description_mapping)

print("✅ 최종 스타일 태그 및 상세 설명 변환 완료.")

# --- 4. 최종 파일 저장 및 확인 ---
final_output_file = 'app/data/stockit_final_tagged_data.csv'
df.to_csv(final_output_file, index=False, encoding='utf-8')

print(f"--- 최종 결과 저장 완료: {final_output_file} ---")
print("✅ 이 파일이 프로젝트 1단계의 최종 산출물입니다. (총 5개 컬럼)")